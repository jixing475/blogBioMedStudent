<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #20794d; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #20794d; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
  <title>ISLR Machine Learning </title>

  <meta property="description" itemprop="description" content="A short description of the post."/>


  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2021-02-03"/>
  <meta property="article:created" itemprop="dateCreated" content="2021-02-03"/>
  <meta name="article:author" content="Jixing Liu"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="ISLR Machine Learning "/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="A short description of the post."/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="ISLR Machine Learning "/>
  <meta property="twitter:description" content="A short description of the post."/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","draft","categories","output","preview"]}},"value":[{"type":"character","attributes":{},"value":["ISLR Machine Learning "]},{"type":"character","attributes":{},"value":["A short description of the post.\n"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url","affiliation","affiliation_url"]}},"value":[{"type":"character","attributes":{},"value":["Jixing Liu"]},{"type":"character","attributes":{},"value":["https://emitanaka.org"]},{"type":"character","attributes":{},"value":["Monash University"]},{"type":"character","attributes":{},"value":["https://numbat.space/"]}]}]},{"type":"character","attributes":{},"value":["2021-02-03"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["machine learning","R"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","highlight","toc","toc_float"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["default"]},{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[true]}]}]},{"type":"character","attributes":{},"value":["islrtreebasedmethods_photo/image-20210617171443567.png"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["cache/__packages","cache/load_pkg_6b7c747c940f5788f973a22233d9c170.RData","cache/load_pkg_6b7c747c940f5788f973a22233d9c170.rdb","cache/load_pkg_6b7c747c940f5788f973a22233d9c170.rdx","cache/unnamed-chunk-1_41e073a4e90c48557501921b61e205d0.RData","cache/unnamed-chunk-1_41e073a4e90c48557501921b61e205d0.rdb","cache/unnamed-chunk-1_41e073a4e90c48557501921b61e205d0.rdx","cache/unnamed-chunk-10_bf0a24b2ec37d02336dad8dedf914102.RData","cache/unnamed-chunk-10_bf0a24b2ec37d02336dad8dedf914102.rdb","cache/unnamed-chunk-10_bf0a24b2ec37d02336dad8dedf914102.rdx","cache/unnamed-chunk-11_d7aab5be00ac6026e797ebb139fe9de2.RData","cache/unnamed-chunk-11_d7aab5be00ac6026e797ebb139fe9de2.rdb","cache/unnamed-chunk-11_d7aab5be00ac6026e797ebb139fe9de2.rdx","cache/unnamed-chunk-12_fbd88f348e8973b03fa7bbb99579b3de.RData","cache/unnamed-chunk-12_fbd88f348e8973b03fa7bbb99579b3de.rdb","cache/unnamed-chunk-12_fbd88f348e8973b03fa7bbb99579b3de.rdx","cache/unnamed-chunk-13_861843abbb803530a900cdc4850c74f2.RData","cache/unnamed-chunk-13_861843abbb803530a900cdc4850c74f2.rdb","cache/unnamed-chunk-13_861843abbb803530a900cdc4850c74f2.rdx","cache/unnamed-chunk-14_13f90a79f404f2d2f92a0be567097e82.RData","cache/unnamed-chunk-14_13f90a79f404f2d2f92a0be567097e82.rdb","cache/unnamed-chunk-14_13f90a79f404f2d2f92a0be567097e82.rdx","cache/unnamed-chunk-15_d59f5cfb55d67ab24905fca1eff7cf63.RData","cache/unnamed-chunk-15_d59f5cfb55d67ab24905fca1eff7cf63.rdb","cache/unnamed-chunk-15_d59f5cfb55d67ab24905fca1eff7cf63.rdx","cache/unnamed-chunk-16_e79f88da39fd309e221d26422f66aaed.RData","cache/unnamed-chunk-16_e79f88da39fd309e221d26422f66aaed.rdb","cache/unnamed-chunk-16_e79f88da39fd309e221d26422f66aaed.rdx","cache/unnamed-chunk-17_7d5debe50440f46dd74f2181aa5d3a6d.RData","cache/unnamed-chunk-17_7d5debe50440f46dd74f2181aa5d3a6d.rdb","cache/unnamed-chunk-17_7d5debe50440f46dd74f2181aa5d3a6d.rdx","cache/unnamed-chunk-2_0c617f6b200a8988fb6eb4ab8ce6f677.RData","cache/unnamed-chunk-2_0c617f6b200a8988fb6eb4ab8ce6f677.rdb","cache/unnamed-chunk-2_0c617f6b200a8988fb6eb4ab8ce6f677.rdx","cache/unnamed-chunk-3_d3b87ec4f27c96a083dc843d9ce19c91.RData","cache/unnamed-chunk-3_d3b87ec4f27c96a083dc843d9ce19c91.rdb","cache/unnamed-chunk-3_d3b87ec4f27c96a083dc843d9ce19c91.rdx","cache/unnamed-chunk-4_9af583b363ee0363a4ee320a7e4c5e9a.RData","cache/unnamed-chunk-4_9af583b363ee0363a4ee320a7e4c5e9a.rdb","cache/unnamed-chunk-4_9af583b363ee0363a4ee320a7e4c5e9a.rdx","cache/unnamed-chunk-5_d5b6c4a75103f3d1cee347a1f4ee5cbd.RData","cache/unnamed-chunk-5_d5b6c4a75103f3d1cee347a1f4ee5cbd.rdb","cache/unnamed-chunk-5_d5b6c4a75103f3d1cee347a1f4ee5cbd.rdx","cache/unnamed-chunk-6_2646d4cd97bfec6232c4248e9c4709a8.RData","cache/unnamed-chunk-6_2646d4cd97bfec6232c4248e9c4709a8.rdb","cache/unnamed-chunk-6_2646d4cd97bfec6232c4248e9c4709a8.rdx","cache/unnamed-chunk-7_82cfa396554aa124c97a721417af21b4.RData","cache/unnamed-chunk-7_82cfa396554aa124c97a721417af21b4.rdb","cache/unnamed-chunk-7_82cfa396554aa124c97a721417af21b4.rdx","cache/unnamed-chunk-8_e34156d2c89e7b843b3b8151f530c34b.RData","cache/unnamed-chunk-8_e34156d2c89e7b843b3b8151f530c34b.rdb","cache/unnamed-chunk-8_e34156d2c89e7b843b3b8151f530c34b.rdx","cache/unnamed-chunk-9_f5f713f2ad91f60ed9f1f283bb59fdd8.RData","cache/unnamed-chunk-9_f5f713f2ad91f60ed9f1f283bb59fdd8.rdb","cache/unnamed-chunk-9_f5f713f2ad91f60ed9f1f283bb59fdd8.rdx","islrtreebasedmethods_files/anchor-4.2.2/anchor.min.js","islrtreebasedmethods_files/bowser-1.9.3/bowser.min.js","islrtreebasedmethods_files/distill-2.2.21/template.v2.js","islrtreebasedmethods_files/header-attrs-2.8.3/header-attrs.js","islrtreebasedmethods_files/jquery-1.11.3/jquery.min.js","islrtreebasedmethods_files/popper-2.6.0/popper.min.js","islrtreebasedmethods_files/tippy-6.2.7/tippy-bundle.umd.min.js","islrtreebasedmethods_files/tippy-6.2.7/tippy-light-border.css","islrtreebasedmethods_files/tippy-6.2.7/tippy.css","islrtreebasedmethods_files/tippy-6.2.7/tippy.umd.min.js","islrtreebasedmethods_files/webcomponents-2.0.0/webcomponents.js","islrtreebasedmethods_photo/download.png","islrtreebasedmethods_photo/image-20210617171443567.png","islrtreebasedmethods_photo/images.png"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refHtml = $('#ref-' + $(this).attr('data-cites')).html();
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="islrtreebasedmethods_files/header-attrs-2.8.3/header-attrs.js"></script>
  <script src="islrtreebasedmethods_files/jquery-1.11.3/jquery.min.js"></script>
  <script src="islrtreebasedmethods_files/popper-2.6.0/popper.min.js"></script>
  <link href="islrtreebasedmethods_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="islrtreebasedmethods_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="islrtreebasedmethods_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="islrtreebasedmethods_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="islrtreebasedmethods_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="islrtreebasedmethods_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="islrtreebasedmethods_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"ISLR Machine Learning ","description":"A short description of the post.","authors":[{"author":"Jixing Liu","authorURL":"https://emitanaka.org","affiliation":"Monash University","affiliationURL":"https://numbat.space/","orcidID":""}],"publishedDate":"2021-02-03T00:00:00.000+00:00","citationText":"Liu, 2021"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>ISLR Machine Learning</h1>
<!--radix_placeholder_categories-->
<div class="dt-tags">
<div class="dt=tag">machine learning</div>
<div class="dt=tag">R</div>
</div>
<!--/radix_placeholder_categories-->
<p><p>A short description of the post.</p></p>
</div>

<div class="d-byline">
  Jixing Liu <a href="https://emitanaka.org" class="uri">https://emitanaka.org</a> (Monash University)<a href="https://numbat.space/" class="uri">https://numbat.space/</a>
  
<br/>2021-02-03
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#load-pkg">load pkg</a></li>
<li><a href="#load-data">load data</a></li>
<li><a href="#split-data">split data</a></li>
<li><a href="#module">🐍 module</a>
<ul>
<li><a href="#r-data-to-python">r data to python</a></li>
<li><a href="#pycaret-setup">pycaret setup</a></li>
<li><a href="#auto-ml">auto ML</a></li>
<li><a href="#model-compare">model compare</a></li>
<li><a href="#create-and-tune-model">create and tune model</a></li>
<li><a href="#extract-data">extract data</a></li>
<li><a href="#plot-metrics">plot metrics</a></li>
<li><a href="#model-predict">📌 model predict</a></li>
<li><a href="#model-save">model save</a></li>
</ul></li>
<li><a href="#model-load">model load</a></li>
</ul>
</nav>
</div>
<p><img src="islrtreebasedmethods_photo/image-20210617171443567.png" /></p>
<h2 id="load-pkg">load pkg</h2>
<h2 id="load-data">load data</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="toggle-code">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://www.StatLearning.com'>ISLR</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://www.stats.ox.ac.uk/pub/MASS4/'>MASS</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidymodels.tidymodels.org'>tidymodels</a></span><span class='op'>)</span>
<span class='co'># Boston &lt;- as_tibble(Boston)</span>
<span class='va'>Carseats</span> <span class='op'>&lt;-</span> <span class='fu'>as_tibble</span><span class='op'>(</span><span class='va'>Carseats</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>High <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='fu'>if_else</span><span class='op'>(</span><span class='va'>Sales</span> <span class='op'>&lt;=</span> <span class='fl'>8</span>, <span class='st'>"No"</span>, <span class='st'>"Yes"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>data</span> <span class='op'>&lt;-</span> 
<span class='va'>Carseats</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>Sales</span><span class='op'>)</span>

<span class='va'>data</span> <span class='op'>&lt;-</span> <span class='va'>data</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>
    High <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='va'>High</span><span class='op'>)</span>,
    High <span class='op'>=</span> <span class='fu'>fct_collapse</span><span class='op'>(</span><span class='va'>High</span>,
                        `0` <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"No"</span><span class='op'>)</span>,
                        `1` <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Yes"</span><span class='op'>)</span><span class='op'>)</span>,
    High <span class='op'>=</span> <span class='fu'>fct_relevel</span><span class='op'>(</span><span class='va'>High</span>,
                       <span class='st'>"0"</span>,
                       <span class='st'>"1"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
</div>
<h2 id="split-data">split data</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="toggle-code">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>123</span><span class='op'>)</span>
<span class='va'>data_split</span> <span class='op'>&lt;-</span> <span class='fu'>initial_split</span><span class='op'>(</span><span class='va'>data</span>, prop <span class='op'>=</span> <span class='fl'>0.7</span><span class='op'>)</span>

<span class='va'>data_train</span> <span class='op'>&lt;-</span> <span class='fu'>training</span><span class='op'>(</span><span class='va'>data_split</span><span class='op'>)</span>
<span class='va'>data_test</span> <span class='op'>&lt;-</span> <span class='fu'>testing</span><span class='op'>(</span><span class='va'>data_split</span><span class='op'>)</span>
</code></pre>
</div>
</div>
</div>
<h1 id="module">🐍 module</h1>
<div class="layout-chunk" data-layout="l-body">
<div class="toggle-code">
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> IPython</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> HTML, display, Markdown, IFrame</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pycaret.classification <span class="im">import</span> <span class="op">*</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd               <span class="co">#data loading and manipulation</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt   <span class="co">#plotting</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns             <span class="co">#statistical plotting</span></span></code></pre></div>
</div>
</div>
<h2 id="r-data-to-python">r data to python</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="toggle-code">
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>train_data <span class="op">=</span> r.data_train</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>test_data <span class="op">=</span> r.data_test</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>train_data.head()</span></code></pre></div>
<pre><code>   CompPrice  Income  Advertising  Population  Price ShelveLoc   Age  \
0      104.0    71.0         14.0        89.0   81.0    Medium  25.0   
1      115.0    28.0         11.0        29.0   86.0      Good  53.0   
2      112.0    98.0         18.0       481.0  128.0    Medium  45.0   
3      115.0    29.0         26.0       394.0  132.0    Medium  33.0   
4      145.0    53.0          0.0       507.0  119.0    Medium  41.0   

   Education Urban   US High  
0       14.0    No  Yes    1  
1       18.0   Yes  Yes    1  
2       11.0   Yes  Yes    0  
3       13.0   Yes  Yes    1  
4       12.0   Yes   No    1  </code></pre>
</div>
</div>
<h2 id="pycaret-setup">pycaret setup</h2>
<p><a href="https://pycaret.org/functions/">Functions - PyCaret</a></p>
<div class="layout-chunk" data-layout="l-body">
<div class="toggle-code">
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>clf1 <span class="op">=</span> setup(data<span class="op">=</span>train_data, </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>             <span class="co">#data_split_shuffle = False,</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>             <span class="co">#ignore_features=[&quot;ID&quot;],</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>             target <span class="op">=</span> <span class="st">&quot;High&quot;</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>             train_size <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>             feature_selection <span class="op">=</span> <span class="va">True</span>,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>             remove_multicollinearity <span class="op">=</span> <span class="va">True</span>,</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>             normalize<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>             ignore_low_variance<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>             session_id<span class="op">=</span><span class="dv">123</span>,</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>             html <span class="op">=</span> <span class="va">False</span>, silent<span class="op">=</span><span class="va">True</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>            )  </span></code></pre></div>
<pre><code>[LightGBM] [Warning] Accuracy may be bad since you didn&#39;t explicitly set num_leaves OR 2^max_depth &gt; num_leaves. (num_leaves=31).
Setup Succesfully Completed!
                               Description             Value
0                               session_id               123
1                                   Target              High
2                              Target Type            Binary
3                            Label Encoded        0: 0, 1: 1
4                            Original Data         (280, 11)
5                           Missing Values             False
6                         Numeric Features                 7
7                     Categorical Features                 3
8                         Ordinal Features             False
9                High Cardinality Features             False
10                 High Cardinality Method              None
11                   Transformed Train Set         (195, 11)
12                    Transformed Test Set          (85, 11)
13                      Shuffle Train-Test              True
14                     Stratify Train-Test             False
15                          Fold Generator   StratifiedKFold
16                             Fold Number                10
17                                CPU Jobs                -1
18                                 Use GPU             False
19                          Log Experiment             False
20                         Experiment Name  clf-default-name
21                                     USI              2891
22                         Imputation Type            simple
23          Iterative Imputation Iteration              None
24                         Numeric Imputer              mean
25      Iterative Imputation Numeric Model              None
26                     Categorical Imputer          constant
27  Iterative Imputation Categorical Model              None
28           Unknown Categoricals Handling    least_frequent
29                               Normalize              True
30                        Normalize Method            zscore
31                          Transformation             False
32                   Transformation Method              None
33                                     PCA             False
34                              PCA Method              None
35                          PCA Components              None
36                     Ignore Low Variance              True
37                     Combine Rare Levels             False
38                    Rare Level Threshold              None
39                         Numeric Binning             False
40                         Remove Outliers             False
41                      Outliers Threshold              None
42                Remove Multicollinearity              True
43             Multicollinearity Threshold               0.9
44                              Clustering             False
45                    Clustering Iteration              None
46                     Polynomial Features             False
47                       Polynomial Degree              None
48                    Trignometry Features             False
49                    Polynomial Threshold              None
50                          Group Features             False
51                       Feature Selection              True
52                Feature Selection Method           classic
53            Features Selection Threshold               0.8
54                     Feature Interaction             False
55                           Feature Ratio             False
56                   Interaction Threshold              None
57                           Fix Imbalance             False
58                    Fix Imbalance Method             SMOTE</code></pre>
</div>
</div>
<h2 id="auto-ml">auto ML</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="toggle-code">
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare all baseline models and select top 5</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>top5 <span class="op">=</span> compare_models(n_select <span class="op">=</span> <span class="dv">5</span>) </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># tune top 5 base models</span></span></code></pre></div>
<pre><code>                  Model  Accuracy     AUC  Recall   Prec.      F1   Kappa  \
lr  Logistic Regression    0.8618  0.9557  0.8694  0.8362  0.8452  0.7206   

       MCC  TT (Sec)  
lr  0.7312     0.373  
                      Model  Accuracy     AUC  Recall   Prec.      F1   Kappa  \
lr      Logistic Regression    0.8618  0.9557  0.8694  0.8362  0.8452  0.7206   
knn  K Neighbors Classifier    0.7582  0.8307  0.6000  0.7663  0.6559  0.4829   

        MCC  TT (Sec)  
lr   0.7312     0.373  
knn  0.4957     0.049  
                      Model  Accuracy     AUC  Recall   Prec.      F1   Kappa  \
lr      Logistic Regression    0.8618  0.9557  0.8694  0.8362  0.8452  0.7206   
knn  K Neighbors Classifier    0.7582  0.8307  0.6000  0.7663  0.6559  0.4829   
nb              Naive Bayes    0.7534  0.8437  0.6181  0.7633  0.6709  0.4815   

        MCC  TT (Sec)  
lr   0.7312     0.373  
knn  0.4957     0.049  
nb   0.4964     0.006  
                        Model  Accuracy     AUC  Recall   Prec.      F1  \
lr        Logistic Regression    0.8618  0.9557  0.8694  0.8362  0.8452   
dt   Decision Tree Classifier    0.7803  0.7714  0.7042  0.7774  0.7265   
knn    K Neighbors Classifier    0.7582  0.8307  0.6000  0.7663  0.6559   
nb                Naive Bayes    0.7534  0.8437  0.6181  0.7633  0.6709   

      Kappa     MCC  TT (Sec)  
lr   0.7206  0.7312     0.373  
dt   0.5460  0.5579     0.006  
knn  0.4829  0.4957     0.049  
nb   0.4815  0.4964     0.006  
                        Model  Accuracy     AUC  Recall   Prec.      F1  \
lr        Logistic Regression    0.8618  0.9557  0.8694  0.8362  0.8452   
svm       SVM - Linear Kernel    0.8255  0.0000  0.8208  0.7946  0.8029   
dt   Decision Tree Classifier    0.7803  0.7714  0.7042  0.7774  0.7265   
knn    K Neighbors Classifier    0.7582  0.8307  0.6000  0.7663  0.6559   
nb                Naive Bayes    0.7534  0.8437  0.6181  0.7633  0.6709   

      Kappa     MCC  TT (Sec)  
lr   0.7206  0.7312     0.373  
svm  0.6464  0.6537     0.006  
dt   0.5460  0.5579     0.006  
knn  0.4829  0.4957     0.049  
nb   0.4815  0.4964     0.006  
                          Model  Accuracy     AUC  Recall   Prec.      F1  \
ridge          Ridge Classifier    0.8771  0.0000  0.8819  0.8498  0.8604   
lr          Logistic Regression    0.8618  0.9557  0.8694  0.8362  0.8452   
svm         SVM - Linear Kernel    0.8255  0.0000  0.8208  0.7946  0.8029   
dt     Decision Tree Classifier    0.7803  0.7714  0.7042  0.7774  0.7265   
knn      K Neighbors Classifier    0.7582  0.8307  0.6000  0.7663  0.6559   
nb                  Naive Bayes    0.7534  0.8437  0.6181  0.7633  0.6709   

        Kappa     MCC  TT (Sec)  
ridge  0.7507  0.7590     0.005  
lr     0.7206  0.7312     0.373  
svm    0.6464  0.6537     0.006  
dt     0.5460  0.5579     0.006  
knn    0.4829  0.4957     0.049  
nb     0.4815  0.4964     0.006  
                          Model  Accuracy     AUC  Recall   Prec.      F1  \
ridge          Ridge Classifier    0.8771  0.0000  0.8819  0.8498  0.8604   
lr          Logistic Regression    0.8618  0.9557  0.8694  0.8362  0.8452   
svm         SVM - Linear Kernel    0.8255  0.0000  0.8208  0.7946  0.8029   
rf     Random Forest Classifier    0.7895  0.8856  0.7486  0.7903  0.7479   
dt     Decision Tree Classifier    0.7803  0.7714  0.7042  0.7774  0.7265   
knn      K Neighbors Classifier    0.7582  0.8307  0.6000  0.7663  0.6559   
nb                  Naive Bayes    0.7534  0.8437  0.6181  0.7633  0.6709   

        Kappa     MCC  TT (Sec)  
ridge  0.7507  0.7590     0.005  
lr     0.7206  0.7312     0.373  
svm    0.6464  0.6537     0.006  
rf     0.5691  0.5910     0.197  
dt     0.5460  0.5579     0.006  
knn    0.4829  0.4957     0.049  
nb     0.4815  0.4964     0.006  
                                 Model  Accuracy     AUC  Recall   Prec.  \
ridge                 Ridge Classifier    0.8771  0.0000  0.8819  0.8498   
lr                 Logistic Regression    0.8618  0.9557  0.8694  0.8362   
svm                SVM - Linear Kernel    0.8255  0.0000  0.8208  0.7946   
rf            Random Forest Classifier    0.7895  0.8856  0.7486  0.7903   
dt            Decision Tree Classifier    0.7803  0.7714  0.7042  0.7774   
knn             K Neighbors Classifier    0.7582  0.8307  0.6000  0.7663   
nb                         Naive Bayes    0.7534  0.8437  0.6181  0.7633   
qda    Quadratic Discriminant Analysis    0.6661  0.8169  0.4139  0.5399   

           F1   Kappa     MCC  TT (Sec)  
ridge  0.8604  0.7507  0.7590     0.005  
lr     0.8452  0.7206  0.7312     0.373  
svm    0.8029  0.6464  0.6537     0.006  
rf     0.7479  0.5691  0.5910     0.197  
dt     0.7265  0.5460  0.5579     0.006  
knn    0.6559  0.4829  0.4957     0.049  
nb     0.6709  0.4815  0.4964     0.006  
qda    0.4319  0.2688  0.3032     0.009  
                                 Model  Accuracy     AUC  Recall   Prec.  \
ridge                 Ridge Classifier    0.8771  0.0000  0.8819  0.8498   
lr                 Logistic Regression    0.8618  0.9557  0.8694  0.8362   
svm                SVM - Linear Kernel    0.8255  0.0000  0.8208  0.7946   
ada               Ada Boost Classifier    0.8000  0.8522  0.7375  0.7921   
rf            Random Forest Classifier    0.7895  0.8856  0.7486  0.7903   
dt            Decision Tree Classifier    0.7803  0.7714  0.7042  0.7774   
knn             K Neighbors Classifier    0.7582  0.8307  0.6000  0.7663   
nb                         Naive Bayes    0.7534  0.8437  0.6181  0.7633   
qda    Quadratic Discriminant Analysis    0.6661  0.8169  0.4139  0.5399   

           F1   Kappa     MCC  TT (Sec)  
ridge  0.8604  0.7507  0.7590     0.005  
lr     0.8452  0.7206  0.7312     0.373  
svm    0.8029  0.6464  0.6537     0.006  
ada    0.7543  0.5864  0.5970     0.034  
rf     0.7479  0.5691  0.5910     0.197  
dt     0.7265  0.5460  0.5579     0.006  
knn    0.6559  0.4829  0.4957     0.049  
nb     0.6709  0.4815  0.4964     0.006  
qda    0.4319  0.2688  0.3032     0.009  
                                 Model  Accuracy     AUC  Recall   Prec.  \
ridge                 Ridge Classifier    0.8771  0.0000  0.8819  0.8498   
lr                 Logistic Regression    0.8618  0.9557  0.8694  0.8362   
svm                SVM - Linear Kernel    0.8255  0.0000  0.8208  0.7946   
gbc       Gradient Boosting Classifier    0.8003  0.8867  0.7750  0.8018   
ada               Ada Boost Classifier    0.8000  0.8522  0.7375  0.7921   
rf            Random Forest Classifier    0.7895  0.8856  0.7486  0.7903   
dt            Decision Tree Classifier    0.7803  0.7714  0.7042  0.7774   
knn             K Neighbors Classifier    0.7582  0.8307  0.6000  0.7663   
nb                         Naive Bayes    0.7534  0.8437  0.6181  0.7633   
qda    Quadratic Discriminant Analysis    0.6661  0.8169  0.4139  0.5399   

           F1   Kappa     MCC  TT (Sec)  
ridge  0.8604  0.7507  0.7590     0.005  
lr     0.8452  0.7206  0.7312     0.373  
svm    0.8029  0.6464  0.6537     0.006  
gbc    0.7719  0.5952  0.6137     0.033  
ada    0.7543  0.5864  0.5970     0.034  
rf     0.7479  0.5691  0.5910     0.197  
dt     0.7265  0.5460  0.5579     0.006  
knn    0.6559  0.4829  0.4957     0.049  
nb     0.6709  0.4815  0.4964     0.006  
qda    0.4319  0.2688  0.3032     0.009  
                                 Model  Accuracy     AUC  Recall   Prec.  \
lda       Linear Discriminant Analysis    0.8824  0.9591  0.8819  0.8587   
ridge                 Ridge Classifier    0.8771  0.0000  0.8819  0.8498   
lr                 Logistic Regression    0.8618  0.9557  0.8694  0.8362   
svm                SVM - Linear Kernel    0.8255  0.0000  0.8208  0.7946   
gbc       Gradient Boosting Classifier    0.8003  0.8867  0.7750  0.8018   
ada               Ada Boost Classifier    0.8000  0.8522  0.7375  0.7921   
rf            Random Forest Classifier    0.7895  0.8856  0.7486  0.7903   
dt            Decision Tree Classifier    0.7803  0.7714  0.7042  0.7774   
knn             K Neighbors Classifier    0.7582  0.8307  0.6000  0.7663   
nb                         Naive Bayes    0.7534  0.8437  0.6181  0.7633   
qda    Quadratic Discriminant Analysis    0.6661  0.8169  0.4139  0.5399   

           F1   Kappa     MCC  TT (Sec)  
lda    0.8656  0.7609  0.7680     0.006  
ridge  0.8604  0.7507  0.7590     0.005  
lr     0.8452  0.7206  0.7312     0.373  
svm    0.8029  0.6464  0.6537     0.006  
gbc    0.7719  0.5952  0.6137     0.033  
ada    0.7543  0.5864  0.5970     0.034  
rf     0.7479  0.5691  0.5910     0.197  
dt     0.7265  0.5460  0.5579     0.006  
knn    0.6559  0.4829  0.4957     0.049  
nb     0.6709  0.4815  0.4964     0.006  
qda    0.4319  0.2688  0.3032     0.009  
                                 Model  Accuracy     AUC  Recall   Prec.  \
lda       Linear Discriminant Analysis    0.8824  0.9591  0.8819  0.8587   
ridge                 Ridge Classifier    0.8771  0.0000  0.8819  0.8498   
lr                 Logistic Regression    0.8618  0.9557  0.8694  0.8362   
svm                SVM - Linear Kernel    0.8255  0.0000  0.8208  0.7946   
gbc       Gradient Boosting Classifier    0.8003  0.8867  0.7750  0.8018   
ada               Ada Boost Classifier    0.8000  0.8522  0.7375  0.7921   
rf            Random Forest Classifier    0.7895  0.8856  0.7486  0.7903   
dt            Decision Tree Classifier    0.7803  0.7714  0.7042  0.7774   
et              Extra Trees Classifier    0.7797  0.8659  0.6528  0.8024   
knn             K Neighbors Classifier    0.7582  0.8307  0.6000  0.7663   
nb                         Naive Bayes    0.7534  0.8437  0.6181  0.7633   
qda    Quadratic Discriminant Analysis    0.6661  0.8169  0.4139  0.5399   

           F1   Kappa     MCC  TT (Sec)  
lda    0.8656  0.7609  0.7680     0.006  
ridge  0.8604  0.7507  0.7590     0.005  
lr     0.8452  0.7206  0.7312     0.373  
svm    0.8029  0.6464  0.6537     0.006  
gbc    0.7719  0.5952  0.6137     0.033  
ada    0.7543  0.5864  0.5970     0.034  
rf     0.7479  0.5691  0.5910     0.197  
dt     0.7265  0.5460  0.5579     0.006  
et     0.7003  0.5343  0.5540     0.186  
knn    0.6559  0.4829  0.4957     0.049  
nb     0.6709  0.4815  0.4964     0.006  
qda    0.4319  0.2688  0.3032     0.009  
                                   Model  Accuracy     AUC  Recall   Prec.  \
lda         Linear Discriminant Analysis    0.8824  0.9591  0.8819  0.8587   
ridge                   Ridge Classifier    0.8771  0.0000  0.8819  0.8498   
lr                   Logistic Regression    0.8618  0.9557  0.8694  0.8362   
svm                  SVM - Linear Kernel    0.8255  0.0000  0.8208  0.7946   
gbc         Gradient Boosting Classifier    0.8003  0.8867  0.7750  0.8018   
ada                 Ada Boost Classifier    0.8000  0.8522  0.7375  0.7921   
xgboost        Extreme Gradient Boosting    0.8000  0.8861  0.7722  0.7809   
rf              Random Forest Classifier    0.7895  0.8856  0.7486  0.7903   
dt              Decision Tree Classifier    0.7803  0.7714  0.7042  0.7774   
et                Extra Trees Classifier    0.7797  0.8659  0.6528  0.8024   
knn               K Neighbors Classifier    0.7582  0.8307  0.6000  0.7663   
nb                           Naive Bayes    0.7534  0.8437  0.6181  0.7633   
qda      Quadratic Discriminant Analysis    0.6661  0.8169  0.4139  0.5399   

             F1   Kappa     MCC  TT (Sec)  
lda      0.8656  0.7609  0.7680     0.006  
ridge    0.8604  0.7507  0.7590     0.005  
lr       0.8452  0.7206  0.7312     0.373  
svm      0.8029  0.6464  0.6537     0.006  
gbc      0.7719  0.5952  0.6137     0.033  
ada      0.7543  0.5864  0.5970     0.034  
xgboost  0.7672  0.5919  0.6025     0.041  
rf       0.7479  0.5691  0.5910     0.197  
dt       0.7265  0.5460  0.5579     0.006  
et       0.7003  0.5343  0.5540     0.186  
knn      0.6559  0.4829  0.4957     0.049  
nb       0.6709  0.4815  0.4964     0.006  
qda      0.4319  0.2688  0.3032     0.009  
                                    Model  Accuracy     AUC  Recall   Prec.  \
lda          Linear Discriminant Analysis    0.8824  0.9591  0.8819  0.8587   
ridge                    Ridge Classifier    0.8771  0.0000  0.8819  0.8498   
lr                    Logistic Regression    0.8618  0.9557  0.8694  0.8362   
svm                   SVM - Linear Kernel    0.8255  0.0000  0.8208  0.7946   
gbc          Gradient Boosting Classifier    0.8003  0.8867  0.7750  0.8018   
ada                  Ada Boost Classifier    0.8000  0.8522  0.7375  0.7921   
xgboost         Extreme Gradient Boosting    0.8000  0.8861  0.7722  0.7809   
lightgbm  Light Gradient Boosting Machine    0.7897  0.8789  0.7708  0.7661   
rf               Random Forest Classifier    0.7895  0.8856  0.7486  0.7903   
dt               Decision Tree Classifier    0.7803  0.7714  0.7042  0.7774   
et                 Extra Trees Classifier    0.7797  0.8659  0.6528  0.8024   
knn                K Neighbors Classifier    0.7582  0.8307  0.6000  0.7663   
nb                            Naive Bayes    0.7534  0.8437  0.6181  0.7633   
qda       Quadratic Discriminant Analysis    0.6661  0.8169  0.4139  0.5399   

              F1   Kappa     MCC  TT (Sec)  
lda       0.8656  0.7609  0.7680     0.006  
ridge     0.8604  0.7507  0.7590     0.005  
lr        0.8452  0.7206  0.7312     0.373  
svm       0.8029  0.6464  0.6537     0.006  
gbc       0.7719  0.5952  0.6137     0.033  
ada       0.7543  0.5864  0.5970     0.034  
xgboost   0.7672  0.5919  0.6025     0.041  
lightgbm  0.7525  0.5700  0.5865     0.020  
rf        0.7479  0.5691  0.5910     0.197  
dt        0.7265  0.5460  0.5579     0.006  
et        0.7003  0.5343  0.5540     0.186  
knn       0.6559  0.4829  0.4957     0.049  
nb        0.6709  0.4815  0.4964     0.006  
qda       0.4319  0.2688  0.3032     0.009  
                                    Model  Accuracy     AUC  Recall   Prec.  \
lda          Linear Discriminant Analysis    0.8824  0.9591  0.8819  0.8587   
ridge                    Ridge Classifier    0.8771  0.0000  0.8819  0.8498   
lr                    Logistic Regression    0.8618  0.9557  0.8694  0.8362   
svm                   SVM - Linear Kernel    0.8255  0.0000  0.8208  0.7946   
gbc          Gradient Boosting Classifier    0.8003  0.8867  0.7750  0.8018   
ada                  Ada Boost Classifier    0.8000  0.8522  0.7375  0.7921   
xgboost         Extreme Gradient Boosting    0.8000  0.8861  0.7722  0.7809   
lightgbm  Light Gradient Boosting Machine    0.7897  0.8789  0.7708  0.7661   
rf               Random Forest Classifier    0.7895  0.8856  0.7486  0.7903   
dt               Decision Tree Classifier    0.7803  0.7714  0.7042  0.7774   
et                 Extra Trees Classifier    0.7797  0.8659  0.6528  0.8024   
knn                K Neighbors Classifier    0.7582  0.8307  0.6000  0.7663   
nb                            Naive Bayes    0.7534  0.8437  0.6181  0.7633   
qda       Quadratic Discriminant Analysis    0.6661  0.8169  0.4139  0.5399   

              F1   Kappa     MCC  TT (Sec)  
lda       0.8656  0.7609  0.7680     0.006  
ridge     0.8604  0.7507  0.7590     0.005  
lr        0.8452  0.7206  0.7312     0.373  
svm       0.8029  0.6464  0.6537     0.006  
gbc       0.7719  0.5952  0.6137     0.033  
ada       0.7543  0.5864  0.5970     0.034  
xgboost   0.7672  0.5919  0.6025     0.041  
lightgbm  0.7525  0.5700  0.5865     0.020  
rf        0.7479  0.5691  0.5910     0.197  
dt        0.7265  0.5460  0.5579     0.006  
et        0.7003  0.5343  0.5540     0.186  
knn       0.6559  0.4829  0.4957     0.049  
nb        0.6709  0.4815  0.4964     0.006  
qda       0.4319  0.2688  0.3032     0.009  </code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>tuned_top5 <span class="op">=</span> [tune_model(i) <span class="cf">for</span> i <span class="kw">in</span> top5]</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ensemble top 5 tuned models</span></span></code></pre></div>
<pre><code>Fitting 10 folds for each of 10 candidates, totalling 100 fits
      Accuracy     AUC  Recall   Prec.      F1   Kappa     MCC
0       0.9000  0.9792  0.7500  1.0000  0.8571  0.7826  0.8018
1       0.8500  0.9596  0.8889  0.8000  0.8421  0.7000  0.7035
2       0.9500  0.9596  0.8889  1.0000  0.9412  0.8980  0.9027
3       0.7500  0.9394  0.5556  0.8333  0.6667  0.4792  0.5044
4       0.8500  0.8990  0.8889  0.8000  0.8421  0.7000  0.7035
5       0.8421  0.9205  0.8750  0.7778  0.8235  0.6816  0.6854
6       1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000
7       0.7895  0.8409  0.7500  0.7500  0.7500  0.5682  0.5682
8       0.9474  0.9886  1.0000  0.8889  0.9412  0.8939  0.8989
9       0.8947  0.9091  0.7500  1.0000  0.8571  0.7765  0.7966
Mean    0.8774  0.9396  0.8347  0.8850  0.8521  0.7480  0.7565
SD      0.0726  0.0459  0.1283  0.0999  0.0914  0.1493  0.1464
Fitting 10 folds for each of 10 candidates, totalling 100 fits
      Accuracy  AUC  Recall   Prec.      F1   Kappa     MCC
0       0.8500  0.0  0.7500  0.8571  0.8000  0.6809  0.6847
1       0.9000  0.0  0.8889  0.8889  0.8889  0.7980  0.7980
2       0.9500  0.0  0.8889  1.0000  0.9412  0.8980  0.9027
3       0.8000  0.0  0.6667  0.8571  0.7500  0.5876  0.6005
4       0.8000  0.0  0.8889  0.7273  0.8000  0.6040  0.6162
5       0.8947  0.0  1.0000  0.8000  0.8889  0.7912  0.8090
6       0.9474  0.0  1.0000  0.8889  0.9412  0.8939  0.8989
7       0.7895  0.0  0.7500  0.7500  0.7500  0.5682  0.5682
8       0.9474  0.0  1.0000  0.8889  0.9412  0.8939  0.8989
9       0.9474  0.0  0.8750  1.0000  0.9333  0.8902  0.8956
Mean    0.8826  0.0  0.8708  0.8658  0.8635  0.7606  0.7673
SD      0.0640  0.0  0.1104  0.0864  0.0762  0.1309  0.1301
Fitting 10 folds for each of 10 candidates, totalling 100 fits
      Accuracy     AUC  Recall   Prec.      F1   Kappa     MCC
0       0.8500  0.9792  0.7500  0.8571  0.8000  0.6809  0.6847
1       0.8000  0.9697  0.8889  0.7273  0.8000  0.6040  0.6162
2       0.9500  0.9798  0.8889  1.0000  0.9412  0.8980  0.9027
3       0.9000  0.9394  0.8889  0.8889  0.8889  0.7980  0.7980
4       0.8000  0.9394  0.8889  0.7273  0.8000  0.6040  0.6162
5       0.8421  0.9318  1.0000  0.7273  0.8421  0.6919  0.7273
6       0.9474  0.9886  1.0000  0.8889  0.9412  0.8939  0.8989
7       0.7895  0.8636  0.8750  0.7000  0.7778  0.5824  0.5955
8       0.8947  0.9886  1.0000  0.8000  0.8889  0.7912  0.8090
9       0.9474  0.9091  0.8750  1.0000  0.9333  0.8902  0.8956
Mean    0.8721  0.9489  0.9056  0.8317  0.8613  0.7434  0.7544
SD      0.0611  0.0385  0.0734  0.1072  0.0617  0.1203  0.1169
Fitting 10 folds for each of 10 candidates, totalling 100 fits
      Accuracy  AUC  Recall   Prec.      F1   Kappa     MCC
0       0.8500  0.0  0.7500  0.8571  0.8000  0.6809  0.6847
1       0.9000  0.0  0.8889  0.8889  0.8889  0.7980  0.7980
2       0.9000  0.0  0.7778  1.0000  0.8750  0.7938  0.8112
3       0.8500  0.0  0.7778  0.8750  0.8235  0.6939  0.6975
4       0.8000  0.0  0.8889  0.7273  0.8000  0.6040  0.6162
5       0.9474  0.0  1.0000  0.8889  0.9412  0.8939  0.8989
6       0.8421  0.0  0.8750  0.7778  0.8235  0.6816  0.6854
7       0.7895  0.0  0.7500  0.7500  0.7500  0.5682  0.5682
8       0.8947  0.0  1.0000  0.8000  0.8889  0.7912  0.8090
9       0.8947  0.0  0.7500  1.0000  0.8571  0.7765  0.7966
Mean    0.8668  0.0  0.8458  0.8565  0.8448  0.7282  0.7366
SD      0.0468  0.0  0.0943  0.0900  0.0531  0.0946  0.0971
Fitting 10 folds for each of 10 candidates, totalling 100 fits
      Accuracy     AUC  Recall   Prec.      F1   Kappa     MCC
0       0.8000  0.8958  0.7500  0.7500  0.7500  0.5833  0.5833
1       0.8000  0.9596  0.8889  0.7273  0.8000  0.6040  0.6162
2       0.8500  0.9697  0.7778  0.8750  0.8235  0.6939  0.6975
3       0.9000  0.9596  0.7778  1.0000  0.8750  0.7938  0.8112
4       0.9000  0.9394  0.8889  0.8889  0.8889  0.7980  0.7980
5       0.8947  0.9205  0.8750  0.8750  0.8750  0.7841  0.7841
6       0.7368  0.8523  0.8750  0.6364  0.7368  0.4865  0.5114
7       0.6842  0.7614  0.5000  0.6667  0.5714  0.3294  0.3380
8       0.8947  0.9432  1.0000  0.8000  0.8889  0.7912  0.8090
9       0.8421  0.8523  0.6250  1.0000  0.7692  0.6587  0.7008
Mean    0.8303  0.9054  0.7958  0.8219  0.7979  0.6523  0.6649
SD      0.0710  0.0627  0.1382  0.1211  0.0934  0.1478  0.1470

[Parallel(n_jobs=-1)]: Using backend LokyBackend with 8 concurrent workers.
[Parallel(n_jobs=-1)]: Done  56 tasks      | elapsed:    0.3s
[Parallel(n_jobs=-1)]: Done 100 out of 100 | elapsed:    0.4s finished
[Parallel(n_jobs=-1)]: Using backend LokyBackend with 8 concurrent workers.
[Parallel(n_jobs=-1)]: Done  56 tasks      | elapsed:    0.2s
[Parallel(n_jobs=-1)]: Done 100 out of 100 | elapsed:    0.3s finished
[Parallel(n_jobs=-1)]: Using backend LokyBackend with 8 concurrent workers.
[Parallel(n_jobs=-1)]: Done  56 tasks      | elapsed:    0.3s
[Parallel(n_jobs=-1)]: Done 100 out of 100 | elapsed:    0.3s finished
[Parallel(n_jobs=-1)]: Using backend LokyBackend with 8 concurrent workers.
[Parallel(n_jobs=-1)]: Done  56 tasks      | elapsed:    0.2s
[Parallel(n_jobs=-1)]: Done 100 out of 100 | elapsed:    0.3s finished
[Parallel(n_jobs=-1)]: Using backend LokyBackend with 8 concurrent workers.
[Parallel(n_jobs=-1)]: Done  34 tasks      | elapsed:    0.8s
[Parallel(n_jobs=-1)]: Done 100 out of 100 | elapsed:    2.6s finished</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>bagged_top5 <span class="op">=</span> [ensemble_model(i) <span class="cf">for</span> i <span class="kw">in</span> tuned_top5]</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># blend top 5 base models </span></span></code></pre></div>
<pre><code>      Accuracy     AUC  Recall   Prec.      F1   Kappa     MCC
0       0.8500  0.9792  0.7500  0.8571  0.8000  0.6809  0.6847
1       0.7500  0.9596  0.8889  0.6667  0.7619  0.5098  0.5334
2       0.9500  0.9798  0.8889  1.0000  0.9412  0.8980  0.9027
3       0.8000  0.9394  0.6667  0.8571  0.7500  0.5876  0.6005
4       0.8500  0.9293  0.8889  0.8000  0.8421  0.7000  0.7035
5       0.8947  0.9205  0.8750  0.8750  0.8750  0.7841  0.7841
6       0.8947  0.9886  0.8750  0.8750  0.8750  0.7841  0.7841
7       0.7895  0.8182  0.7500  0.7500  0.7500  0.5682  0.5682
8       0.8947  0.9886  0.8750  0.8750  0.8750  0.7841  0.7841
9       0.8947  0.9091  0.7500  1.0000  0.8571  0.7765  0.7966
Mean    0.8568  0.9412  0.8208  0.8556  0.8327  0.7073  0.7142
SD      0.0581  0.0495  0.0784  0.0963  0.0613  0.1150  0.1118
      Accuracy     AUC  Recall   Prec.      F1   Kappa     MCC
0       0.9000  0.9740  0.8750  0.8750  0.8750  0.7917  0.7917
1       0.8000  0.9596  0.8889  0.7273  0.8000  0.6040  0.6162
2       0.9500  0.9899  0.8889  1.0000  0.9412  0.8980  0.9027
3       0.8500  0.8788  0.7778  0.8750  0.8235  0.6939  0.6975
4       0.8500  0.8384  0.8889  0.8000  0.8421  0.7000  0.7035
5       0.8947  0.9432  0.8750  0.8750  0.8750  0.7841  0.7841
6       0.9474  0.9886  1.0000  0.8889  0.9412  0.8939  0.8989
7       0.8421  0.8182  0.7500  0.8571  0.8000  0.6705  0.6746
8       0.9474  0.9886  0.8750  1.0000  0.9333  0.8902  0.8956
9       0.9474  0.9375  0.8750  1.0000  0.9333  0.8902  0.8956
Mean    0.8929  0.9317  0.8694  0.8898  0.8765  0.7816  0.7860
SD      0.0521  0.0608  0.0640  0.0852  0.0552  0.1040  0.1031
      Accuracy     AUC  Recall   Prec.      F1   Kappa     MCC
0       0.9000  0.9792  0.8750  0.8750  0.8750  0.7917  0.7917
1       0.7500  0.9596  0.8889  0.6667  0.7619  0.5098  0.5334
2       0.9000  0.9798  0.8889  0.8889  0.8889  0.7980  0.7980
3       0.9000  0.9394  0.8889  0.8889  0.8889  0.7980  0.7980
4       0.8500  0.9394  0.8889  0.8000  0.8421  0.7000  0.7035
5       0.8947  0.9545  1.0000  0.8000  0.8889  0.7912  0.8090
6       0.9474  0.9773  1.0000  0.8889  0.9412  0.8939  0.8989
7       0.7895  0.8523  0.8750  0.7000  0.7778  0.5824  0.5955
8       0.8947  0.9886  1.0000  0.8000  0.8889  0.7912  0.8090
9       0.8947  0.9205  0.7500  1.0000  0.8571  0.7765  0.7966
Mean    0.8721  0.9491  0.9056  0.8308  0.8611  0.7433  0.7534
SD      0.0564  0.0384  0.0734  0.0936  0.0518  0.1091  0.1051
      Accuracy     AUC  Recall   Prec.      F1   Kappa     MCC
0       0.8500  0.9271  0.7500  0.8571  0.8000  0.6809  0.6847
1       0.8500  0.9242  1.0000  0.7500  0.8571  0.7059  0.7385
2       0.9500  0.9798  0.8889  1.0000  0.9412  0.8980  0.9027
3       0.8000  0.8384  0.6667  0.8571  0.7500  0.5876  0.6005
4       0.7500  0.8990  0.7778  0.7000  0.7368  0.5000  0.5025
5       0.8947  0.9432  1.0000  0.8000  0.8889  0.7912  0.8090
6       0.8947  0.9375  0.8750  0.8750  0.8750  0.7841  0.7841
7       0.7895  0.8125  0.7500  0.7500  0.7500  0.5682  0.5682
8       0.8947  0.9830  0.8750  0.8750  0.8750  0.7841  0.7841
9       0.8947  0.9318  0.7500  1.0000  0.8571  0.7765  0.7966
Mean    0.8568  0.9176  0.8333  0.8464  0.8331  0.7076  0.7171
SD      0.0581  0.0521  0.1067  0.0955  0.0661  0.1172  0.1190
      Accuracy     AUC  Recall   Prec.      F1   Kappa     MCC
0       0.7500  0.8958  0.6250  0.7143  0.6667  0.4681  0.4708
1       0.8000  0.8687  0.8889  0.7273  0.8000  0.6040  0.6162
2       0.8000  0.9596  0.6667  0.8571  0.7500  0.5876  0.6005
3       0.8000  0.9596  0.6667  0.8571  0.7500  0.5876  0.6005
4       0.8000  0.8788  0.8889  0.7273  0.8000  0.6040  0.6162
5       0.8421  0.9091  0.7500  0.8571  0.8000  0.6705  0.6746
6       0.7895  0.9091  0.7500  0.7500  0.7500  0.5682  0.5682
7       0.7368  0.7727  0.6250  0.7143  0.6667  0.4509  0.4536
8       0.7895  0.9432  0.7500  0.7500  0.7500  0.5682  0.5682
9       0.7895  0.9091  0.6250  0.8333  0.7143  0.5529  0.5673
Mean    0.7897  0.9006  0.7236  0.7788  0.7448  0.5662  0.5736
SD      0.0275  0.0518  0.0961  0.0606  0.0473  0.0615  0.0635</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>blender <span class="op">=</span> blend_models(estimator_list <span class="op">=</span> top5) </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># select best model </span></span></code></pre></div>
<pre><code>      Accuracy  AUC  Recall   Prec.      F1   Kappa     MCC
0       0.8500  0.0  0.7500  0.8571  0.8000  0.6809  0.6847
1       0.9000  0.0  0.8889  0.8889  0.8889  0.7980  0.7980
2       0.9500  0.0  0.8889  1.0000  0.9412  0.8980  0.9027
3       0.8500  0.0  0.7778  0.8750  0.8235  0.6939  0.6975
4       0.8000  0.0  0.8889  0.7273  0.8000  0.6040  0.6162
5       0.8947  0.0  1.0000  0.8000  0.8889  0.7912  0.8090
6       0.8947  0.0  1.0000  0.8000  0.8889  0.7912  0.8090
7       0.7895  0.0  0.7500  0.7500  0.7500  0.5682  0.5682
8       0.8947  0.0  1.0000  0.8000  0.8889  0.7912  0.8090
9       0.9474  0.0  0.8750  1.0000  0.9333  0.8902  0.8956
Mean    0.8771  0.0  0.8819  0.8498  0.8604  0.7507  0.7590
SD      0.0518  0.0  0.0936  0.0893  0.0599  0.1055  0.1070</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>best <span class="op">=</span> automl(optimize <span class="op">=</span> <span class="st">&#39;Recall&#39;</span>)</span></code></pre></div>
</div>
</div>
<h2 id="model-compare">model compare</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="toggle-code">
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>models()</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 比较所有模型</span></span></code></pre></div>
<pre><code>                                     Name  ...  Turbo
ID                                         ...       
lr                    Logistic Regression  ...   True
knn                K Neighbors Classifier  ...   True
nb                            Naive Bayes  ...   True
dt               Decision Tree Classifier  ...   True
svm                   SVM - Linear Kernel  ...   True
rbfsvm                SVM - Radial Kernel  ...  False
gpc           Gaussian Process Classifier  ...  False
mlp                        MLP Classifier  ...  False
ridge                    Ridge Classifier  ...   True
rf               Random Forest Classifier  ...   True
qda       Quadratic Discriminant Analysis  ...   True
ada                  Ada Boost Classifier  ...   True
gbc          Gradient Boosting Classifier  ...   True
lda          Linear Discriminant Analysis  ...   True
et                 Extra Trees Classifier  ...   True
xgboost         Extreme Gradient Boosting  ...   True
lightgbm  Light Gradient Boosting Machine  ...   True

[17 rows x 3 columns]</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>res_compare_models <span class="op">=</span> compare_models(sort <span class="op">=</span> <span class="st">&quot;AUC&quot;</span>)</span></code></pre></div>
<pre><code>                  Model  Accuracy     AUC  Recall   Prec.      F1   Kappa  \
lr  Logistic Regression    0.8618  0.9557  0.8694  0.8362  0.8452  0.7206   

       MCC  TT (Sec)  
lr  0.7312     0.008  
                      Model  Accuracy     AUC  Recall   Prec.      F1   Kappa  \
lr      Logistic Regression    0.8618  0.9557  0.8694  0.8362  0.8452  0.7206   
knn  K Neighbors Classifier    0.7582  0.8307  0.6000  0.7663  0.6559  0.4829   

        MCC  TT (Sec)  
lr   0.7312     0.008  
knn  0.4957     0.047  
                      Model  Accuracy     AUC  Recall   Prec.      F1   Kappa  \
lr      Logistic Regression    0.8618  0.9557  0.8694  0.8362  0.8452  0.7206   
nb              Naive Bayes    0.7534  0.8437  0.6181  0.7633  0.6709  0.4815   
knn  K Neighbors Classifier    0.7582  0.8307  0.6000  0.7663  0.6559  0.4829   

        MCC  TT (Sec)  
lr   0.7312     0.008  
nb   0.4964     0.007  
knn  0.4957     0.047  
                        Model  Accuracy     AUC  Recall   Prec.      F1  \
lr        Logistic Regression    0.8618  0.9557  0.8694  0.8362  0.8452   
nb                Naive Bayes    0.7534  0.8437  0.6181  0.7633  0.6709   
knn    K Neighbors Classifier    0.7582  0.8307  0.6000  0.7663  0.6559   
dt   Decision Tree Classifier    0.7803  0.7714  0.7042  0.7774  0.7265   

      Kappa     MCC  TT (Sec)  
lr   0.7206  0.7312     0.008  
nb   0.4815  0.4964     0.007  
knn  0.4829  0.4957     0.047  
dt   0.5460  0.5579     0.007  
                        Model  Accuracy     AUC  Recall   Prec.      F1  \
lr        Logistic Regression    0.8618  0.9557  0.8694  0.8362  0.8452   
nb                Naive Bayes    0.7534  0.8437  0.6181  0.7633  0.6709   
knn    K Neighbors Classifier    0.7582  0.8307  0.6000  0.7663  0.6559   
dt   Decision Tree Classifier    0.7803  0.7714  0.7042  0.7774  0.7265   
svm       SVM - Linear Kernel    0.8255  0.0000  0.8208  0.7946  0.8029   

      Kappa     MCC  TT (Sec)  
lr   0.7206  0.7312     0.008  
nb   0.4815  0.4964     0.007  
knn  0.4829  0.4957     0.047  
dt   0.5460  0.5579     0.007  
svm  0.6464  0.6537     0.006  
                          Model  Accuracy     AUC  Recall   Prec.      F1  \
lr          Logistic Regression    0.8618  0.9557  0.8694  0.8362  0.8452   
nb                  Naive Bayes    0.7534  0.8437  0.6181  0.7633  0.6709   
knn      K Neighbors Classifier    0.7582  0.8307  0.6000  0.7663  0.6559   
dt     Decision Tree Classifier    0.7803  0.7714  0.7042  0.7774  0.7265   
svm         SVM - Linear Kernel    0.8255  0.0000  0.8208  0.7946  0.8029   
ridge          Ridge Classifier    0.8771  0.0000  0.8819  0.8498  0.8604   

        Kappa     MCC  TT (Sec)  
lr     0.7206  0.7312     0.008  
nb     0.4815  0.4964     0.007  
knn    0.4829  0.4957     0.047  
dt     0.5460  0.5579     0.007  
svm    0.6464  0.6537     0.006  
ridge  0.7507  0.7590     0.006  
                          Model  Accuracy     AUC  Recall   Prec.      F1  \
lr          Logistic Regression    0.8618  0.9557  0.8694  0.8362  0.8452   
rf     Random Forest Classifier    0.7895  0.8856  0.7486  0.7903  0.7479   
nb                  Naive Bayes    0.7534  0.8437  0.6181  0.7633  0.6709   
knn      K Neighbors Classifier    0.7582  0.8307  0.6000  0.7663  0.6559   
dt     Decision Tree Classifier    0.7803  0.7714  0.7042  0.7774  0.7265   
svm         SVM - Linear Kernel    0.8255  0.0000  0.8208  0.7946  0.8029   
ridge          Ridge Classifier    0.8771  0.0000  0.8819  0.8498  0.8604   

        Kappa     MCC  TT (Sec)  
lr     0.7206  0.7312     0.008  
rf     0.5691  0.5910     0.209  
nb     0.4815  0.4964     0.007  
knn    0.4829  0.4957     0.047  
dt     0.5460  0.5579     0.007  
svm    0.6464  0.6537     0.006  
ridge  0.7507  0.7590     0.006  
                                 Model  Accuracy     AUC  Recall   Prec.  \
lr                 Logistic Regression    0.8618  0.9557  0.8694  0.8362   
rf            Random Forest Classifier    0.7895  0.8856  0.7486  0.7903   
nb                         Naive Bayes    0.7534  0.8437  0.6181  0.7633   
knn             K Neighbors Classifier    0.7582  0.8307  0.6000  0.7663   
qda    Quadratic Discriminant Analysis    0.6661  0.8169  0.4139  0.5399   
dt            Decision Tree Classifier    0.7803  0.7714  0.7042  0.7774   
svm                SVM - Linear Kernel    0.8255  0.0000  0.8208  0.7946   
ridge                 Ridge Classifier    0.8771  0.0000  0.8819  0.8498   

           F1   Kappa     MCC  TT (Sec)  
lr     0.8452  0.7206  0.7312     0.008  
rf     0.7479  0.5691  0.5910     0.209  
nb     0.6709  0.4815  0.4964     0.007  
knn    0.6559  0.4829  0.4957     0.047  
qda    0.4319  0.2688  0.3032     0.008  
dt     0.7265  0.5460  0.5579     0.007  
svm    0.8029  0.6464  0.6537     0.006  
ridge  0.8604  0.7507  0.7590     0.006  
                                 Model  Accuracy     AUC  Recall   Prec.  \
lr                 Logistic Regression    0.8618  0.9557  0.8694  0.8362   
rf            Random Forest Classifier    0.7895  0.8856  0.7486  0.7903   
ada               Ada Boost Classifier    0.8000  0.8522  0.7375  0.7921   
nb                         Naive Bayes    0.7534  0.8437  0.6181  0.7633   
knn             K Neighbors Classifier    0.7582  0.8307  0.6000  0.7663   
qda    Quadratic Discriminant Analysis    0.6661  0.8169  0.4139  0.5399   
dt            Decision Tree Classifier    0.7803  0.7714  0.7042  0.7774   
svm                SVM - Linear Kernel    0.8255  0.0000  0.8208  0.7946   
ridge                 Ridge Classifier    0.8771  0.0000  0.8819  0.8498   

           F1   Kappa     MCC  TT (Sec)  
lr     0.8452  0.7206  0.7312     0.008  
rf     0.7479  0.5691  0.5910     0.209  
ada    0.7543  0.5864  0.5970     0.038  
nb     0.6709  0.4815  0.4964     0.007  
knn    0.6559  0.4829  0.4957     0.047  
qda    0.4319  0.2688  0.3032     0.008  
dt     0.7265  0.5460  0.5579     0.007  
svm    0.8029  0.6464  0.6537     0.006  
ridge  0.8604  0.7507  0.7590     0.006  
                                 Model  Accuracy     AUC  Recall   Prec.  \
lr                 Logistic Regression    0.8618  0.9557  0.8694  0.8362   
gbc       Gradient Boosting Classifier    0.8003  0.8867  0.7750  0.8018   
rf            Random Forest Classifier    0.7895  0.8856  0.7486  0.7903   
ada               Ada Boost Classifier    0.8000  0.8522  0.7375  0.7921   
nb                         Naive Bayes    0.7534  0.8437  0.6181  0.7633   
knn             K Neighbors Classifier    0.7582  0.8307  0.6000  0.7663   
qda    Quadratic Discriminant Analysis    0.6661  0.8169  0.4139  0.5399   
dt            Decision Tree Classifier    0.7803  0.7714  0.7042  0.7774   
svm                SVM - Linear Kernel    0.8255  0.0000  0.8208  0.7946   
ridge                 Ridge Classifier    0.8771  0.0000  0.8819  0.8498   

           F1   Kappa     MCC  TT (Sec)  
lr     0.8452  0.7206  0.7312     0.008  
gbc    0.7719  0.5952  0.6137     0.032  
rf     0.7479  0.5691  0.5910     0.209  
ada    0.7543  0.5864  0.5970     0.038  
nb     0.6709  0.4815  0.4964     0.007  
knn    0.6559  0.4829  0.4957     0.047  
qda    0.4319  0.2688  0.3032     0.008  
dt     0.7265  0.5460  0.5579     0.007  
svm    0.8029  0.6464  0.6537     0.006  
ridge  0.8604  0.7507  0.7590     0.006  
                                 Model  Accuracy     AUC  Recall   Prec.  \
lda       Linear Discriminant Analysis    0.8824  0.9591  0.8819  0.8587   
lr                 Logistic Regression    0.8618  0.9557  0.8694  0.8362   
gbc       Gradient Boosting Classifier    0.8003  0.8867  0.7750  0.8018   
rf            Random Forest Classifier    0.7895  0.8856  0.7486  0.7903   
ada               Ada Boost Classifier    0.8000  0.8522  0.7375  0.7921   
nb                         Naive Bayes    0.7534  0.8437  0.6181  0.7633   
knn             K Neighbors Classifier    0.7582  0.8307  0.6000  0.7663   
qda    Quadratic Discriminant Analysis    0.6661  0.8169  0.4139  0.5399   
dt            Decision Tree Classifier    0.7803  0.7714  0.7042  0.7774   
svm                SVM - Linear Kernel    0.8255  0.0000  0.8208  0.7946   
ridge                 Ridge Classifier    0.8771  0.0000  0.8819  0.8498   

           F1   Kappa     MCC  TT (Sec)  
lda    0.8656  0.7609  0.7680     0.007  
lr     0.8452  0.7206  0.7312     0.008  
gbc    0.7719  0.5952  0.6137     0.032  
rf     0.7479  0.5691  0.5910     0.209  
ada    0.7543  0.5864  0.5970     0.038  
nb     0.6709  0.4815  0.4964     0.007  
knn    0.6559  0.4829  0.4957     0.047  
qda    0.4319  0.2688  0.3032     0.008  
dt     0.7265  0.5460  0.5579     0.007  
svm    0.8029  0.6464  0.6537     0.006  
ridge  0.8604  0.7507  0.7590     0.006  
                                 Model  Accuracy     AUC  Recall   Prec.  \
lda       Linear Discriminant Analysis    0.8824  0.9591  0.8819  0.8587   
lr                 Logistic Regression    0.8618  0.9557  0.8694  0.8362   
gbc       Gradient Boosting Classifier    0.8003  0.8867  0.7750  0.8018   
rf            Random Forest Classifier    0.7895  0.8856  0.7486  0.7903   
et              Extra Trees Classifier    0.7797  0.8659  0.6528  0.8024   
ada               Ada Boost Classifier    0.8000  0.8522  0.7375  0.7921   
nb                         Naive Bayes    0.7534  0.8437  0.6181  0.7633   
knn             K Neighbors Classifier    0.7582  0.8307  0.6000  0.7663   
qda    Quadratic Discriminant Analysis    0.6661  0.8169  0.4139  0.5399   
dt            Decision Tree Classifier    0.7803  0.7714  0.7042  0.7774   
svm                SVM - Linear Kernel    0.8255  0.0000  0.8208  0.7946   
ridge                 Ridge Classifier    0.8771  0.0000  0.8819  0.8498   

           F1   Kappa     MCC  TT (Sec)  
lda    0.8656  0.7609  0.7680     0.007  
lr     0.8452  0.7206  0.7312     0.008  
gbc    0.7719  0.5952  0.6137     0.032  
rf     0.7479  0.5691  0.5910     0.209  
et     0.7003  0.5343  0.5540     0.193  
ada    0.7543  0.5864  0.5970     0.038  
nb     0.6709  0.4815  0.4964     0.007  
knn    0.6559  0.4829  0.4957     0.047  
qda    0.4319  0.2688  0.3032     0.008  
dt     0.7265  0.5460  0.5579     0.007  
svm    0.8029  0.6464  0.6537     0.006  
ridge  0.8604  0.7507  0.7590     0.006  
                                   Model  Accuracy     AUC  Recall   Prec.  \
lda         Linear Discriminant Analysis    0.8824  0.9591  0.8819  0.8587   
lr                   Logistic Regression    0.8618  0.9557  0.8694  0.8362   
gbc         Gradient Boosting Classifier    0.8003  0.8867  0.7750  0.8018   
xgboost        Extreme Gradient Boosting    0.8000  0.8861  0.7722  0.7809   
rf              Random Forest Classifier    0.7895  0.8856  0.7486  0.7903   
et                Extra Trees Classifier    0.7797  0.8659  0.6528  0.8024   
ada                 Ada Boost Classifier    0.8000  0.8522  0.7375  0.7921   
nb                           Naive Bayes    0.7534  0.8437  0.6181  0.7633   
knn               K Neighbors Classifier    0.7582  0.8307  0.6000  0.7663   
qda      Quadratic Discriminant Analysis    0.6661  0.8169  0.4139  0.5399   
dt              Decision Tree Classifier    0.7803  0.7714  0.7042  0.7774   
svm                  SVM - Linear Kernel    0.8255  0.0000  0.8208  0.7946   
ridge                   Ridge Classifier    0.8771  0.0000  0.8819  0.8498   

             F1   Kappa     MCC  TT (Sec)  
lda      0.8656  0.7609  0.7680     0.007  
lr       0.8452  0.7206  0.7312     0.008  
gbc      0.7719  0.5952  0.6137     0.032  
xgboost  0.7672  0.5919  0.6025     0.046  
rf       0.7479  0.5691  0.5910     0.209  
et       0.7003  0.5343  0.5540     0.193  
ada      0.7543  0.5864  0.5970     0.038  
nb       0.6709  0.4815  0.4964     0.007  
knn      0.6559  0.4829  0.4957     0.047  
qda      0.4319  0.2688  0.3032     0.008  
dt       0.7265  0.5460  0.5579     0.007  
svm      0.8029  0.6464  0.6537     0.006  
ridge    0.8604  0.7507  0.7590     0.006  
                                    Model  Accuracy     AUC  Recall   Prec.  \
lda          Linear Discriminant Analysis    0.8824  0.9591  0.8819  0.8587   
lr                    Logistic Regression    0.8618  0.9557  0.8694  0.8362   
gbc          Gradient Boosting Classifier    0.8003  0.8867  0.7750  0.8018   
xgboost         Extreme Gradient Boosting    0.8000  0.8861  0.7722  0.7809   
rf               Random Forest Classifier    0.7895  0.8856  0.7486  0.7903   
lightgbm  Light Gradient Boosting Machine    0.7897  0.8789  0.7708  0.7661   
et                 Extra Trees Classifier    0.7797  0.8659  0.6528  0.8024   
ada                  Ada Boost Classifier    0.8000  0.8522  0.7375  0.7921   
nb                            Naive Bayes    0.7534  0.8437  0.6181  0.7633   
knn                K Neighbors Classifier    0.7582  0.8307  0.6000  0.7663   
qda       Quadratic Discriminant Analysis    0.6661  0.8169  0.4139  0.5399   
dt               Decision Tree Classifier    0.7803  0.7714  0.7042  0.7774   
svm                   SVM - Linear Kernel    0.8255  0.0000  0.8208  0.7946   
ridge                    Ridge Classifier    0.8771  0.0000  0.8819  0.8498   

              F1   Kappa     MCC  TT (Sec)  
lda       0.8656  0.7609  0.7680     0.007  
lr        0.8452  0.7206  0.7312     0.008  
gbc       0.7719  0.5952  0.6137     0.032  
xgboost   0.7672  0.5919  0.6025     0.046  
rf        0.7479  0.5691  0.5910     0.209  
lightgbm  0.7525  0.5700  0.5865     0.013  
et        0.7003  0.5343  0.5540     0.193  
ada       0.7543  0.5864  0.5970     0.038  
nb        0.6709  0.4815  0.4964     0.007  
knn       0.6559  0.4829  0.4957     0.047  
qda       0.4319  0.2688  0.3032     0.008  
dt        0.7265  0.5460  0.5579     0.007  
svm       0.8029  0.6464  0.6537     0.006  
ridge     0.8604  0.7507  0.7590     0.006  
                                    Model  Accuracy     AUC  Recall   Prec.  \
lda          Linear Discriminant Analysis    0.8824  0.9591  0.8819  0.8587   
lr                    Logistic Regression    0.8618  0.9557  0.8694  0.8362   
gbc          Gradient Boosting Classifier    0.8003  0.8867  0.7750  0.8018   
xgboost         Extreme Gradient Boosting    0.8000  0.8861  0.7722  0.7809   
rf               Random Forest Classifier    0.7895  0.8856  0.7486  0.7903   
lightgbm  Light Gradient Boosting Machine    0.7897  0.8789  0.7708  0.7661   
et                 Extra Trees Classifier    0.7797  0.8659  0.6528  0.8024   
ada                  Ada Boost Classifier    0.8000  0.8522  0.7375  0.7921   
nb                            Naive Bayes    0.7534  0.8437  0.6181  0.7633   
knn                K Neighbors Classifier    0.7582  0.8307  0.6000  0.7663   
qda       Quadratic Discriminant Analysis    0.6661  0.8169  0.4139  0.5399   
dt               Decision Tree Classifier    0.7803  0.7714  0.7042  0.7774   
svm                   SVM - Linear Kernel    0.8255  0.0000  0.8208  0.7946   
ridge                    Ridge Classifier    0.8771  0.0000  0.8819  0.8498   

              F1   Kappa     MCC  TT (Sec)  
lda       0.8656  0.7609  0.7680     0.007  
lr        0.8452  0.7206  0.7312     0.008  
gbc       0.7719  0.5952  0.6137     0.032  
xgboost   0.7672  0.5919  0.6025     0.046  
rf        0.7479  0.5691  0.5910     0.209  
lightgbm  0.7525  0.5700  0.5865     0.013  
et        0.7003  0.5343  0.5540     0.193  
ada       0.7543  0.5864  0.5970     0.038  
nb        0.6709  0.4815  0.4964     0.007  
knn       0.6559  0.4829  0.4957     0.047  
qda       0.4319  0.2688  0.3032     0.008  
dt        0.7265  0.5460  0.5579     0.007  
svm       0.8029  0.6464  0.6537     0.006  
ridge     0.8604  0.7507  0.7590     0.006  </code></pre>
</div>
</div>
<h2 id="create-and-tune-model">create and tune model</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="toggle-code">
<div class="sourceCode" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> create_model(<span class="st">&#39;lr&#39;</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 模型调参</span></span></code></pre></div>
<pre><code>      Accuracy     AUC  Recall   Prec.      F1   Kappa     MCC
0       0.8500  0.9688  0.7500  0.8571  0.8000  0.6809  0.6847
1       0.8000  0.9697  0.8889  0.7273  0.8000  0.6040  0.6162
2       0.9500  0.9798  0.8889  1.0000  0.9412  0.8980  0.9027
3       0.8500  0.9394  0.7778  0.8750  0.8235  0.6939  0.6975
4       0.8000  0.9495  0.8889  0.7273  0.8000  0.6040  0.6162
5       0.8947  0.9545  1.0000  0.8000  0.8889  0.7912  0.8090
6       0.8947  0.9886  0.8750  0.8750  0.8750  0.7841  0.7841
7       0.7895  0.8636  0.8750  0.7000  0.7778  0.5824  0.5955
8       0.8947  1.0000  1.0000  0.8000  0.8889  0.7912  0.8090
9       0.8947  0.9432  0.7500  1.0000  0.8571  0.7765  0.7966
Mean    0.8618  0.9557  0.8694  0.8362  0.8452  0.7206  0.7312
SD      0.0503  0.0360  0.0850  0.1010  0.0502  0.0986  0.0984</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>model_tuned <span class="op">=</span> tune_model(model, optimize <span class="op">=</span> <span class="st">&quot;AUC&quot;</span>, n_iter <span class="op">=</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code>Fitting 10 folds for each of 10 candidates, totalling 100 fits
      Accuracy     AUC  Recall   Prec.      F1   Kappa     MCC
0       0.9000  0.9479  0.8750  0.8750  0.8750  0.7917  0.7917
1       0.8500  0.9596  1.0000  0.7500  0.8571  0.7059  0.7385
2       0.9500  0.9798  0.8889  1.0000  0.9412  0.8980  0.9027
3       0.8500  0.9697  0.7778  0.8750  0.8235  0.6939  0.6975
4       0.8000  0.9192  0.8889  0.7273  0.8000  0.6040  0.6162
5       0.8421  0.9545  1.0000  0.7273  0.8421  0.6919  0.7273
6       0.8421  0.9659  0.8750  0.7778  0.8235  0.6816  0.6854
7       0.7895  0.8636  0.8750  0.7000  0.7778  0.5824  0.5955
8       0.8947  0.9886  1.0000  0.8000  0.8889  0.7912  0.8090
9       0.9474  0.9659  0.8750  1.0000  0.9333  0.8902  0.8956
Mean    0.8666  0.9515  0.9056  0.8232  0.8562  0.7331  0.7459
SD      0.0525  0.0343  0.0688  0.1046  0.0512  0.1023  0.0994

[Parallel(n_jobs=-1)]: Using backend LokyBackend with 8 concurrent workers.
[Parallel(n_jobs=-1)]: Done  56 tasks      | elapsed:    0.3s
[Parallel(n_jobs=-1)]: Done 100 out of 100 | elapsed:    0.4s finished</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>model_tuned</span></code></pre></div>
<pre><code>LogisticRegression(C=9.984, class_weight=&#39;balanced&#39;, dual=False,
                   fit_intercept=True, intercept_scaling=1, l1_ratio=None,
                   max_iter=1000, multi_class=&#39;auto&#39;, n_jobs=None, penalty=&#39;l2&#39;,
                   random_state=123, solver=&#39;lbfgs&#39;, tol=0.0001, verbose=0,
                   warm_start=False)</code></pre>
</div>
</div>
<h2 id="extract-data">extract data</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="toggle-code">
<div class="sourceCode" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 提取数据</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>data_x <span class="op">=</span> get_config(<span class="st">&#39;X&#39;</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>data_x.head()</span></code></pre></div>
<pre><code>   Advertising  ShelveLoc_Medium  US_No  ...       Age  ShelveLoc_Good  Population
0     1.122684               1.0    0.0  ... -1.716371             0.0   -1.248700
1     0.664686               0.0    0.0  ...  0.036273             1.0   -1.657342
2     1.733350               1.0    0.0  ... -0.464483             0.0    1.421098
3     2.954680               1.0    0.0  ... -1.215616             0.0    0.828566
4    -1.014644               1.0    1.0  ... -0.714860             0.0    1.598177

[5 rows x 11 columns]</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>data_x.shape</span></code></pre></div>
<pre><code>(280, 11)</code></pre>
</div>
</div>
<h2 id="plot-metrics">plot metrics</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="toggle-code">
<div class="sourceCode" id="cb29"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 指标查看 </span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>plot_model(best , plot<span class="op">=</span><span class="st">&#39;auc&#39;</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Hyperparameters         == parameter</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># AUC                     == auc</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Confusion Matrix        == confusion_matrix</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Threshold               == threshold</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Precision Recall        == pr</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Prediction Error        == error</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Class Report            == class_report</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Feature Selection       == rfe</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Learning Curve          == learning</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Manifold Learning       == manifold</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Calibration Curve       == calibration</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Validation Curve        == vc</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Dimensions              == dimension</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Feature Importance      == feature</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Feature Importance All  == feature_all</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Decision Boundary       == boundary</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Lift Chart              == lift</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Gain Chart              == gain</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Decision Tree           == tree</span></span></code></pre></div>
<img src="figures/unnamed-chunk-3-1.png" width="768" style="display: block; margin: auto;" />
</div>
</div>
<h2 id="model-predict">📌 model predict</h2>
<p><a href="https://github.com/pycaret/pycaret/issues/893">Obtaining Transformed Unseen Data · Issue #893 · pycaret/pycaret</a></p>
<div class="layout-chunk" data-layout="l-body">
<div class="toggle-code">
<div class="sourceCode" id="cb30"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>unseen_data <span class="op">=</span> test_data</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>prep_pipe <span class="op">=</span> get_config(<span class="st">&#39;prep_pipe&#39;</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>transformed_unseen_data <span class="op">=</span> prep_pipe.transform(unseen_data)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>transformed_unseen_data.shape</span></code></pre></div>
<pre><code>(120, 11)</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="toggle-code">
<div class="sourceCode" id="cb32"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>unseen_predictions <span class="op">=</span> test_data</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>unseen_predictions[<span class="st">&#39;Label&#39;</span>] <span class="op">=</span> pd.Series(best.predict(transformed_unseen_data)) </span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>unseen_predictions[<span class="st">&#39;Score&#39;</span>] <span class="op">=</span> pd.Series(best.predict_proba(transformed_unseen_data)[:,<span class="dv">1</span>])</span></code></pre></div>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="toggle-code">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>py</span><span class='op'>$</span><span class='va'>unseen_predictions</span> <span class='op'>&lt;-</span> 
<span class='va'>py</span><span class='op'>$</span><span class='va'>unseen_predictions</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>Label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>Label</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="toggle-code">
<div class="sourceCode" id="cb33"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pycaret.utils <span class="im">import</span> check_metric</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>check_metric(unseen_predictions[<span class="st">&#39;High&#39;</span>], unseen_predictions[<span class="st">&#39;Label&#39;</span>], metric <span class="op">=</span> <span class="st">&#39;Accuracy&#39;</span>)</span></code></pre></div>
<pre><code>0.875</code></pre>
</div>
</div>
<h2 id="model-save">model save</h2>
<h1 id="model-load">model load</h1>
<div class="sourceCode" id="cb35"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
